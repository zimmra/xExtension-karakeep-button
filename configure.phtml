<?php

declare(strict_types=1);
/** @var KarakeepButtonExtension $this */
$instance_url = FreshRSS_Context::$user_conf->karakeep_instance_url ?: '';
$api_key = FreshRSS_Context::$user_conf->karakeep_api_key ?: '';
$keyboard_shortcut = FreshRSS_Context::$user_conf->karakeep_keyboard_shortcut ?: '';
?>

<form action="<?= _url('extension', 'configure', 'e', urlencode($this->getName())) ?>" method="post">
  <input type="hidden" name="_csrf" value="<?= FreshRSS_Auth::csrfToken() ?>" />
  
  <div class="form-group">
    <label class="group-name" for="instance_url"><?= _t('ext.karakeepButton.configure.instance_url'); ?></label>
    <div class="group-controls">
      <input type="url" name="instance_url" id="instance_url" value="<?= htmlspecialchars($instance_url); ?>" placeholder="https://your-karakeep-instance.com">
    </div>
  </div>

  <div class="form-group">
    <label class="group-name" for="api_key"><?= _t('ext.karakeepButton.configure.api_key'); ?></label>
    <div class="group-controls">
      <input type="text" name="api_key" id="api_key" value="<?= htmlspecialchars($api_key); ?>" placeholder="your-api-key">
    </div>
  </div>

  <div class="form-group">
    <label class="group-name" for="keyboard_shortcut"><?= _t('ext.karakeepButton.configure.keyboard_shortcut'); ?></label>
    <div class="group-controls">
      <input type="text" name="keyboard_shortcut" id="keyboard_shortcut" maxlength="1" value="<?= htmlspecialchars($keyboard_shortcut); ?>">
      <p class="help"><?= _t('ext.karakeepButton.configure.keyboard_shortcut_help'); ?></p>
    </div>
  </div>

  <div class="form-group form-actions">
    <div class="group-controls">
      <button type="submit" class="btn btn-important"><?= _t('gen.action.submit'); ?></button>
    </div>
  </div>
</form>

<?php if (!empty($instance_url) && !empty($api_key)) : ?>
  <div class="alert alert-success">
    <p><?= _t('ext.karakeepButton.configure.connected_to_karakeep', $instance_url); ?></p>
  </div>
<?php endif ?>

<div class="form-group">
  <label class="group-name"><?= _t('ext.karakeepButton.configure.instructions_title'); ?></label>
  <div class="group-controls">
    <div class="alert alert-info">
      <?= _t('ext.karakeepButton.configure.instructions'); ?>
    </div>
  </div>
</div>